# План разработки игры Asteroids (только HTML, CSS, JS)

Цель: реализовать классическую аркаду Asteroids в браузере без фреймворков и сборщиков, используя только чистые HTML, CSS и JavaScript (ESM или IIFE), с канвасом для рендера.

## MVP чек‑лист (минимально играбельно)
- Корабль: поворот, ускорение, инерция, стрельба.
- Астероиды: генерация, движение, разбиение на более мелкие при попадании.
- Снаряды: выстрел, время жизни, уничтожение астероидов.
- Коллизии: снаряд‑астероид, корабль‑астероид, потеря жизни.
- Игровые состояния: старт/игра/пауза/конец, перезапуск.
- Счет и рекорд (localStorage).

## Структура проекта (простая, без сборщика)
```
/ (корень репозитория)
  index.html
  styles.css
  main.js            # точка входа
  js/
    input.js         # управление/события
    math.js          # утилиты математики/рандома
    renderer.js      # функции рендера на canvas
    state.js         # общее состояние игры, сцены
    entities/
      ship.js
      asteroid.js
      bullet.js
    systems/
      collisions.js
      particles.js
      waves.js       # волны/баланс
  assets/            # опционально: звуки/иконки
```
Примечание: допускается ESM (`<script type="module">`) или самовызывающиеся модули (IIFE). Никаких внешних библиотек.

---

## Пошаговый план

1) Подготовка и базовый каркас
- Создать `index.html`, `styles.css`, `main.js`.
- В `index.html`: `<meta viewport>`, `<canvas id="game">`, контейнеры HUD/overlay.
- Подключить `styles.css` и `main.js` (как модуль или обычным скриптом).

2) Базовая стилизация и раскладка
- Растянуть канвас на окно, задать фон, отключить выделение текста.
- Простые слои UI: HUD (очки/жизни), overlay (старт/пауза/конец).

3) Инициализация canvas и игрового цикла
- Получить 2D‑контекст, настроить размер с учетом `devicePixelRatio`.
- Реализовать `loop(t)`: расчет `dt` c ограничением (напр. max 1/30 c) и `requestAnimationFrame`.
- Разделить `update(dt)` и `render(ctx)`.

4) Система координат и обертка экрана (wrap)
- Принять мировые координаты = экранные; при выходе за границы — появление с другой стороны.
- Утилиты: `wrap(x, max)`, нормализация углов.

5) Ввод
- `input.js`: слушатели `keydown/keyup` на `window` (или PointerLock по желанию).
- Карта действий: thrust, rotateLeft, rotateRight, shoot, pause.
- Позже: тач‑управление (виртуальные кнопки) — опционально.

6) Утилиты и математика
- `math.js`: случайные числа, линейная интерполяция, длина/нормализация векторов, угол‑вектор.
- Константы: `TAU`, лимиты скоростей, ускорения.

7) Общее состояние и сцены
- `state.js`: объект `game` (очки, жизни, волна, сцена, таймеры).
- Сцены: `start`, `playing`, `paused`, `gameover` с простыми переходами.

8) Корабль
- `ship.js`: позиция, угол, скорость, ускорение, трение, максимальная скорость.
- Управление: поворот (влево/вправо), тяга вперед, стрельба с перезарядкой (cooldown).
- Респаун и краткая неуязвимость с мерцанием спрайта/контура.

9) Снаряды
- `bullet.js`: старт из носа корабля, фиксированная скорость, время жизни (TTL) ~1–1.5 c.
- Пул объектов, чтобы избегать лишних аллокаций.

10) Астероиды
- `asteroid.js`: генерация многоугольников с небольшим шумом/неравномерностью.
- Размеры: большой → средний → маленький; скорость и очки зависят от размера.
- Спавн волной за пределами безопасного радиуса от корабля.

11) Система волн и прогрессия
- `waves.js`: начальное число астероидов и рост сложности по волнам.
- Переход на следующую волну при отсутствии астероидов (стартовая задержка).

12) Коллизии
- `collisions.js`: broad‑phase (AABB/радиусы), затем точнее — круги/точка‑в‑многоугольнике.
- Реакции: 
  - пуля×астероид → разрушение/разбиение, частицы, очки;
  - корабль×астероид → потеря жизни, респаун/gameover.

13) Рендеринг
- `renderer.js`: очистка экрана, рендер корабля (треугольник/контур), астероидов (полигоны), пуль.
- Рендер HUD (очки, жизни, волна) поверх канваса.

14) Эффекты и частицы
- `particles.js`: выхлоп при тяге, взрывы при разрушении.
- Простые параметры: позиция, скорость, затухание, цвет/размер.

15) Звук (без библиотек)
- Использовать Web Audio API или `<audio>` для: выстрела, thrust, взрыва.
- Кнопка mute, разумные уровни громкости.

16) Пауза, старт и конец игры
- Overlay с инструкциями на старте, затем скрывать при начале.
- Пауза по `Escape`, экран `Game Over` с перезапуском (Enter/Click).

17) Сохранение рекорда
- `localStorage`: хранить лучший счет, показывать в HUD/overlay.

18) Респонсивность и масштаб
- Обработчик `resize`: пересчет размеров канваса, устойчивость к DPR.
- Ограничение максимального размера для слабых устройств, сохранение соотношения.

19) Управление для тач‑устройств (опционально)
- Простейшие on‑screen кнопки: поворот/тяга/стрельба/пауза.
- Большие hit‑areas и визуальная обратная связь.

20) Оптимизация и полировка
- Пулы объектов (пули/частицы), переиспользование массивов.
- Сокращение аллокаций в `update/render`, кэширование вычислений.
- Отрисовка тонкими контурами, минимизация операций canvas.

21) Отладка и качество
- Debug‑режим: отображение хитбоксов, FPS, счетчиков объектов.
- Горячие клавиши для быстрых сценариев (например, спавн волны).

22) Рефакторинг и документация
- Уборка дублирования, разбиение на небольшие модули.
- Краткий `README` по запуску и управлению.

23) Финальные проверки и деплой
- Проверка в нескольких браузерах (Chrome/Firefox/Safari) и на мобилках.
- Деплой как статические файлы (например, GitHub Pages). Никакого бэкенда не требуется.

24) Идеи расширений (после 1.0)
- Враги UFO, бонусы (щит/замедление/телепорт), альтернативные режимы.
- Таблица рекордов (локальная), сид генерации для «ежедневного» челленджа.
- Настройки сложности, ремап клавиш.

---

## Критерии готовности версии 1.0
- Стабильные 60 FPS на десктопе при типичном числе объектов.
- Все пункты из MVP реализованы; отсутствуют критические баги с коллизиями/респауном.
- Интерфейс понятен: управление, пауза, перезапуск, отображение счета/жизней.
- Корректное сохранение/загрузка рекорда из `localStorage`.
